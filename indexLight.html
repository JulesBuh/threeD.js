<!DOCTYPE HTML>
<html>
	<head>
		<title>Daylighting Diagram</title>
		<style>
			body {
			margin: 0;
			overflow:hidden;
			background-color:#000000;
			color:#ffffff;
			}
			canvas {
			width: 100%;
			height: 100% }
		</style>
		<script type="text/javascript" src="https://threejs.org/build/three.js"/></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<script type="text/javascript" src="https://threejs.org/examples/js/libs/dat.gui.min.js"></script>
		<script type="text/javascript" src="https://threejs.org/examples/js/libs/stats.min.js"></script>
		<script type="text/javascript" src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
	</head>
	<body>
	<H1>Daylighting Diagram 2</H1>
		 <div id="webGL-container"></div>
		<script type="text/javascript"> 
			$(function () {
			// Global Variables
				var scene, camera, renderer;
				var controls, guiControls, datGUI;
				var axis, grid, color;
				var wallGeometry,floorGeometry,ceilingGeometry,windowGeometry,planeGeometry;
				var planeMaterial, planeMaterial;
				var wall, plane;
				var spotlight,spotlight2;
				var stats;
				var SCREEN_WIDTH, SCREEN_HEIGHT;
			// Starting Scene
			// scene
				scene = new THREE.Scene();
			// camera
				camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
			// renderer
				renderer = new THREE.WebGLRenderer();
						renderer.setClearColor(0xffffff);
					renderer.setSize(window.innerWidth, window.innerHeight);
					renderer.sshadowMapEnabled = true;
					renderer.sshadowMapSoft = true;
			// ContructSceneInContainer
				$("#webGL-container").append(renderer.domElement);
			// Navigation Controls
				controls = new THREE.OrbitControls( camera, renderer.domElement );
							controls.addEventListener( 'change', render );
							
			// axisPlanes
				axis = new THREE.AxisHelper(10);
							
				grid = new THREE.GridHelper( 50, 50 );
							grid.material.opacity = 0.25;
							grid.material.transparent = true;
				planeGeometry = new THREE.PlaneGeometry(5, 1, 1);
				planeMaterial = new THREE.MeshLambertMaterial({color: 0x0033aa});
				planeMaterial.side = THREE.DoubleSide
				planeMaterial.opacity = 0.5;
				planeMaterial.transparent  = true;
				plane = new THREE.Mesh(planeGeometry, planeMaterial);
			// wall
				wallGeometry = new THREE.BoxGeometry(1, 2.5, 0.30);
				wall_principal_Geometry = new THREE.BoxGeometry(1, 1, 0.30);
				wallMaterial = new THREE.MeshLambertMaterial({color: 0x3663FF});
				wall = new THREE.Mesh(wall_principal_Geometry, wallMaterial);
				wall_cill = new THREE.Mesh(wall_principal_Geometry, wallMaterial);
				wall_head = new THREE.Mesh(wall_principal_Geometry, wallMaterial);
				wall2 = new THREE.Mesh(wallGeometry, wallMaterial);
				wall3 = new THREE.Mesh(wallGeometry, wallMaterial);
				
				windowGeometry = new THREE.BoxGeometry(1.1, 0.9, 0.4);
				windowMaterial = new THREE.MeshLambertMaterial({color: 0xbbaaff});
				opening = new THREE.Mesh(windowGeometry, windowMaterial);
				
					//var newBSP = wall.subtract(opening); //Boolean opreatins with ThreeCSG.js
				
				ceilingGeometry = new THREE.BoxGeometry(1, 0.3, 1);
				floorGeometry = new THREE.BoxGeometry(1, 0.3, 1);
				ceiling = new THREE.Mesh(ceilingGeometry, wallMaterial);
				floor = new THREE.Mesh(floorGeometry, wallMaterial);
				
			// spotlight
				spotlight = new THREE.SpotLight(0xffffff);
				spotlight2 = new THREE.SpotLight(0xeeeeff);
							
			// add objects to the scene
				//globalGrid placement
					grid.position.x = 0;
					grid.position.y = 0;
					grid.position.z = 0;
					grid.rotation.x = 0;
					grid.rotation.y = 0;
					grid.rotation.z = 0;
					scene.add(grid);
				//wall placement
					wall.scale.x = 2.5;
					wall.scale.y = 2.5;
					wall.position.x = 1.25;
					wall.rotation.x = 0;
					wall.rotation.y = 0;
					wall.rotation.z = 0;
					wall.castShadow = true;
					wall2.position.set(2.5, 1.25, 2.5);
					wall3.position.set(0, 1.25, -5);
					wall_cill.scale.y = 1.1;
					wall_cill.scale.x = 2.5;
					wall_cill.position.x = -1.25;
					wall_cill.position.y = 0.5;
					wall_head.scale.y = 0.9;
					wall_head.scale.x = 2.5;
					wall_head.position.x = -1.25;
					wall_head.position.y = 2.1;
					
					scene.add(wall);
					scene.add(wall_cill);
					scene.add(wall_head);
					scene.add(wall2);
					scene.add(wall3);
					scene.add(floor);
					scene.add(ceiling);
					
					//scene.add(newBSP); //Boolean opreatins with ThreeCSG.js
					
					//opening.position.set(-2.5+0.5, 1.5, 0);
					//scene.add(opening);
				//plane placement
					plane.scale.set( 1, 1, 1 );
					plane.position.y = 0.5;
					plane.rotation.y = Math.PI;
					plane.receiveShadow = true;
					scene.add(plane);
				//lighting placement
					spotlight.position.set(-15, 30, 60);
					spotlight.castShadow = true;
					scene.add(spotlight);
					spotlight2.position.set(-12, 15, -5);
					spotlight2.castShadow = true;
					scene.add(spotlight2);
				//camera placement
					camera.position.set(-10, 5, 2.5);
					camera.lookAt(scene.position);
			// Controls
				// InteractiveControls
				var guiControls = new function(){
					this.rotationX_deg = 0;
					this.rotationY_deg = 0;
					this.rotationZ_deg = 0;
					this.object = 'wall';
					this.positionX = 0;
					this.positionY = 0;
					this.positionZ = 0;
					this.room_Depth = 5;
					this.obstruction_Position = 5;
					this.obstruction_Height_above_Window_Head = 5;
					this.window_opening_Height = 1.0;
					this.window_cill_Height_above_FFL = 1.05;
				}
				var datGUI = new dat.GUI();
				//datGUI.add(guiControls, 'rotationX_deg', -45, 45);
				//datGUI.add(guiControls, 'rotationY_deg', -360, 360);
				//datGUI.add(guiControls, 'rotationZ_deg', -360, 360);
				//datGUI.add(guiControls, 'positionX', -30.1, 30.1);
				//datGUI.add(guiControls, 'positionY', -30.1, 30.1);
				//datGUI.add(guiControls, 'positionZ', -30.1, 0);
				datGUI.add(guiControls, 'room_Depth', 1, 30);
				datGUI.add(guiControls, 'obstruction_Position', 0.5, 30);
				datGUI.add(guiControls, 'obstruction_Height_above_Window_Head', 0, 20);
				datGUI.add(guiControls, 'window_opening_Height', 0, 2.4);
				datGUI.add(guiControls, 'window_cill_Height_above_FFL', 0.05, 1.2);
				//datGUI.add(guiControls, 'object', ['wall','ceiling','floor','obstruction','window']);
				
				function window_head(){
					this.height = Number(guiControls.window_cill_Height_above_FFL)+Number(guiControls.window_opening_Height);
					this.wall_height = 2.5-Number(guiControls.window_cill_Height_above_FFL)-Number(guiControls.window_opening_Height);
				}
				
				function render(){
					axis.rotation.x = Number(guiControls.rotationX_deg)/180*Math.PI;
					axis.rotation.y = Number(guiControls.rotationY_deg)/180*Math.PI;
					axis.rotation.z = Number(guiControls.rotationZ_deg)/180*Math.PI;
					wall.rotation.x = Number(guiControls.rotationX_deg)/180*Math.PI;
					wall.rotation.y = Number(guiControls.rotationY_deg)/180*Math.PI;
					wall.rotation.z = Number(guiControls.rotationZ_deg)/180*Math.PI;
					wall_cill.scale.set( 2.5, Number(guiControls.window_cill_Height_above_FFL), 1 );
					wall_cill.position.set(-1.25,Number(guiControls.window_cill_Height_above_FFL)/2,0);
					wall_head.scale.set( 2.5, 2.5-Number(guiControls.window_cill_Height_above_FFL)-Number(guiControls.window_opening_Height), 1);
					wall_head.position.set(-1.25,(Number(guiControls.window_cill_Height_above_FFL)+Number(guiControls.window_opening_Height))+(2.5-Number(guiControls.window_cill_Height_above_FFL)-Number(guiControls.window_opening_Height))/2,0);
					wall.position.set(1.25,Number(guiControls.positionY) + 1.25,Number(guiControls.positionZ));
					axis.position.set(-Number(guiControls.positionX)/2,Number(guiControls.positionY) + 1.25,Number(guiControls.positionZ));
					wall2.rotation.y = 90/180*Math.PI;
					wall2.position.set(Number(guiControls.positionX)+2.35,Number(guiControls.positionY) + 1.25,Number(guiControls.positionZ)-(Number(guiControls.room_Depth)/2));
					wall2.scale.x = Number(guiControls.room_Depth);
					wall3.scale.x = 5;
					wall3.position.set(Number(guiControls.positionX),Number(guiControls.positionY) + 1.25,Number(guiControls.positionZ)-(Number(guiControls.room_Depth)));
					wall3.rotation.y = 180/180*Math.PI;
					floor.position.set(Number(guiControls.positionX),-0.15,Number(guiControls.positionZ)-(Number(guiControls.room_Depth))/2);
					floor.scale.x=5;
					floor.scale.z=Number(guiControls.room_Depth)+0.3;
					ceiling.position.set(Number(guiControls.positionX),2.5,Number(guiControls.positionZ)-(Number(guiControls.room_Depth))/2);
					ceiling.scale.x=5;
					ceiling.scale.z=Number(guiControls.room_Depth)+0.3;
					plane.scale.set( 1, Number(guiControls.obstruction_Height_above_Window_Head)+Number(guiControls.window_cill_Height_above_FFL)+Number(guiControls.window_opening_Height)+0.3, 1 );
					plane.position.y = ((guiControls.obstruction_Height_above_Window_Head+Number(guiControls.window_cill_Height_above_FFL)+Number(guiControls.window_opening_Height)-0.3)/2);
					plane.position.z = Number(guiControls.obstruction_Position);
				}
				function animate(){
					requestAnimationFrame(animate);
					render();     
					renderer.render(scene, camera);
				}
				$(window).resize(function(){
					SCREEN_WIDTH = window.innerWidth;
					SCREEN_HEIGHT = window.innerHeight;
					camera.aspect = SCREEN_WIDTH / SCREEN_HEIGHT;
					camera.updateProjectionMatrix();
					renderer.setSize( SCREEN_WIDTH, SCREEN_HEIGHT );
				});
				
				animate();
			});
		</script>
	</body>
</html>
